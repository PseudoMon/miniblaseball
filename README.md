# MiniBlaseball Website
Hullo, this repository is for the code that runs the #MiniBlaseball website. I wrote this readme to my future self so I don't get lost if I want to get back to this, and well, I guess also for anyone who want to help fix bugs or is learning web development!

This website is built with Riot and Rollup. It's designed to only run only in the frontend from a single file and a single address. I use some Python scripting to grab and collate metadata for each players, which is exported into a JSON and then loaded into the app. 

Metadata is taken from the images' filename and in a file written using the [Eno notation language](https://eno-lang.org/).

Note that this repository does not contain the images! The website will look broken and you won't be able to run the Python scripts without them.

## Requirements
A recent version of Node and a Node package manager. I use PNPM, but it should work the same way if you use NPM or other package manager that uses the same package.json format.

If you want to run the scripts that generate players data, you'll need Python 3 and the Python enolib package.

You'll need something to run a server from the `dist` directory. I use Python's builtin simple server, but anything else will work. 

## Generating player data
Running `processplayers.py` inside `dist/images` will generate a JSON file containing the data for all players. Players and their names are determined from the images and their filename. Size determination is (for now) manually coded into the script. Other metadata (like team placement) is in `extradata.eno`

Image filename should be in the format e.g. `98JoshuaWatson.png`, with alt color schemes being e.g. `98JoshuaWatsonALT.png` and `98JoshuaWatsonALT2.png`. The script already adjusts for players with "Mc" in their name (e.g. McDowell Mason), NaN, and Evelton McBlase II.

A player's "size" decides where the cut-off will be when viewing the player's page. Most players are probably `small`, some are `large`, and for a couple few, they need to be slightly larger than large: `xlarge`. The maximum is Peanutiel Duffy's `huge`.

The generated JSON is automatically placed in `src/players.json`.

Team data should be manually inputted into `teams.eno`. Running `processplayers.json` will also create the file containing teams data `src/teams.json`. 

## Running the website on your machine
Install with this (or however your package manager install).

```
pnpm install
``` 

And then run rollup from the configuration file

```
rollup -c -w
```

That will put all the JavaScript source code into an `app.js` file in the dist folder, which is then read by `index.html` when you open it. The website functions rely on being run from a server, so you'll have to run a server based on that directory. I use Python, so I can just `cd dist` and then run this :

```
python -m http.server
```

## The website's source code
Most of the processing happens in the main `app.riot` file, with some components having their own component files. `players.json` contains players data and should be generated by the Python script. `teams.json` contains the teams divided by subleagues, to be displayed in the filter control. For now this file is manually created.

`teamsReverseId.js` contain codes that flatten that teams JSON into a single array, and then transform that array into an object in which team names become keys and their values is their index within that array. Savvy? It's for sorting by teams, so you can just compare their team index.

Someday we'll find a way to automate creation of the team file.

## Readying for distribution
Run rollup without using watch. It'll result in a minified production-ready file (todo: this is not yet true)
```
rollup -c
```